---
sudo: required
dist: bionic

notifications:
  slack:
    on_failure: always

matrix:
  fast_finish: true
  include:


# https://skaffold.dev/docs/install/    
    - name: "deploy skaffold w homebrew on macOS 10.15.7 osx xcode12.2"
      os: osx
      osx_image:
        - xcode12.2 #macOS 10.15.7
      addons:
        homebrew:
          packages:
          - skaffold
          update: true
      # language: java
      before_install:
        - pip3 install virtualenv
        - virtualenv -p $(which python3) ~venvpy3
        - source ~venvpy3/bin/activate
        - python --version
        - pip install -r requirements.txt
      script:
      - skaffold version
      after_success:
        - deactivate

# https://www.macports.org/
# https://skaffold.dev/docs/install/    
    - name: "deploy skaffold via MacPorts wo homebrew on macOS macOS 10.14.6 osx xcode11"
      os: osx
      osx_image:
        - xcode11 #macOS 10.15.7
      before_install:
        - pip3 install virtualenv
        - virtualenv -p $(which python3) ~venvpy3
        - source ~venvpy3/bin/activate
        - python --version
        - pip install -r requirements.txt
      script:
      # By default port is installed the directory /opt/local/bin
      - export PATH=$PATH:/opt/local/bin
      - sudo port install skaffold
      after_success:
        - deactivate

# https://skaffold.dev/docs/install/    
    - name: "deploy skaffold via script wo homebrew on macOS 10.15.7 osx xcode12.2"
      os: osx
      osx_image:
        - xcode12.2 #macOS 10.15.7
      addons:
        homebrew:
          packages:
          - python
          - curl
          update: true
      language: java
      before_install:
        - pip3 install virtualenv
        - virtualenv -p $(which python3) ~venvpy3
        - source ~venvpy3/bin/activate
        - python --version
        - pip install -r requirements.txt
      script:
      - curl -Lo skaffold https://storage.googleapis.com/skaffold/releases/latest/skaffold-darwin-amd64 && \
      - sudo install skaffold /usr/local/bin/
      after_success:
        - deactivate
